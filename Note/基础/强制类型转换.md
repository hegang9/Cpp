# C++ 强制类型转换

## static_cast

### 用途

编译时的类型转换，不涉及运行时检查，处理编译器认可的隐式转换。

### 使用场景

- 基本数据类型转换
- 类层次结构的上行转换（派生类 → 基类，**安全**）
- 下行转换（基类 → 派生类，**不安全**，运行时可能崩溃）
- `void*` 与具体类型指针互转

## dynamic_cast

### 用途

运行时的类型转换，涉及运行时检查，性能开销大。

### 使用场景

- 在继承体系中进行安全的向下转型（基类 → 派生类）
- 多态类的下行转换（需基类含虚函数）

### 转换失败处理

- 指针转换失败返回 `nullptr`
- 引用转换失败抛出 `std::bad_cast`

## const_cast

### 用途

添加或移除 `const` 或 `volatile` 属性。

### 使用场景

- 移除 `const` 属性（可能引起未定义行为）
- 添加 `const` 属性（适配常量接口）
- 成员函数重载优化（避免代码重复，例如在 const 函数里调用非 const 版本）

## reinterpret_cast

### 用途

低级别、不安全的类型转换，无视类型关系。无类型安全检查。

### 使用场景

- 指针与整数互转（如内存地址操作）
- 无关指针类型互转（如 `int*` 转 `char*`）
- 函数指针类型转换（兼容 C 回调）

## 总结表格

| 类型转换 | 编译期/运行期 | 安全性 | 主要用途 |
|---------|-------------|------|---------|
| static_cast | 编译期 | 中等 | 基本类型转换、上行转换 |
| dynamic_cast | 运行期 | 高 | 安全的下行转换 |
| const_cast | 编译期 | 低 | 移除/添加 const 属性 |
| reinterpret_cast | 编译期 | 低 | 指针与整数互转、无关指针互转 |
