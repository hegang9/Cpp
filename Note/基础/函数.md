# 函数

## 内联函数

内联函数使用相应的函数代码替换函数调用，增大了内存但减小了时间开销。

### 使用要求（两个条件选一个）

1. 在函数声明前加上关键字 `inline`
2. 在函数定义前加上关键字 `inline`

## 引用基础概念

### 引用变量的初始化

引用变量必须在声明引用变量时进行初始化。

### 引用返回类型

- 常规（非引用）返回类型是右值——不能通过地址访问的值
- 引用返回类型是可修改的左值
- 若不想允许对引用返回值的赋值，需将返回值设置为 const

### 非常量引用与常量引用的区别

非常量引用不能指向其他类型，常量引用可以指向其他类型。

**原因分析**（以 int 变量赋值给 double 型引用为例）：

- **隐式转换过程**：int 到 double 的转换会生成一个临时 double 对象（例如 `static_cast<double>(a)`），但临时对象默认是右值（无法修改的临时值）
- **引用的权限限制**：非 const 引用（如 `double&`）要求直接修改原对象，而临时对象无法被直接修改，因此编译器禁止这种操作以规避潜在的逻辑错误

## 引用使用原则

### 对于使用传递的值而不作修改的函数

- 如果数据对象很小，如内置数据类型或小型结构，则按值传递
- 如果数据对象是数组，则使用指针，因为这是唯一的选择，并将指针声明为指向 const 的指针
- 如果数据对象是较大的结构，则使用 const 指针或 const 引用，以提高程序的效率
- 如果数据对象是类对象，则使用 const 引用。类设计的语义常常要求使用引用

### 对于修改调用函数中数据的函数

- 如果数据对象是内置数据类型，则使用指针
- 如果数据对象是数组，则只能使用指针
- 如果数据对象是结构，则使用引用或指针
- 如果数据对象是类对象，则使用引用

## 函数参数默认值

对于带参数列表的函数，必须从右向左添加默认值。也就是说，要为某个参数设置默认值，则必须为它右边的所有参数提供默认值。

## 函数重载

### 函数特征标

函数重载的关键是函数的参数列表——也称为函数特征标。

- 如果两个函数的参数数目和类型相同，同时参数的排列顺序也相同，则它们的特征标相同
- 变量名和返回值是无关紧要的
- C++ 允许定义名称相同的函数，条件是它们的特征标不同

### 注意事项

- 类型引用和类型本身视为同一个特征标
- const 和非 const 是不同的特征标

## 函数模板

### 函数模板声明和定义

函数模板也可以进行重载。

```cpp
template <typename T>  // 这里的 typename 可以替换为 class
void swap(T a, T b);

template <typename T>
void swap(T a, T b)
{
    return;
}
```

### 显式具体化与显式实例化

对于给定的函数名，可以有非模板函数、模板函数和显式具体化模板函数以及它们的重载版本。

**显式具体化**（必须给出新的函数体）：

```cpp
template<> void swap(int s, int b) {
    return;
}

template<> void swap<int>(int s, int b) {
    return;
}
```

**显式实例化**：

```cpp
template void swap<int>(int a, int b);
// 显式实例化不能写函数体，因为函数体已经在函数模板中定义了
// 这个语法与显式具体化就在 template 后少了个 <>
```

### 重要提示

试图在同一个文件（或转换单元）中使用同一种类型的显式实例和显式具体化将出错。

## 优先级规则

具体化优先于常规模板，而非模板函数优先于具体化和常规模板。
